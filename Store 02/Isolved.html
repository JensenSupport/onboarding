<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <title>ISolved Resources | Store 02</title>
    <link rel="stylesheet" href="../shared-style.css">
    <style>
        .cred-box {
            width: 90%;
            max-width: 600px;
            background: #000;
            color: #fff;
            padding: 10px;
            margin-top: 10px;
            margin-bottom: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: background 0.3s ease;
            cursor: pointer;
            display: inline-block;
        }
        .cred-box:hover {
            background: #222;
        }
        .cred-box small {
            display: block;
            margin-top: 5px;
            font-size: 12px;
            color: #ccc;
        }

        .instructions {
            margin-top: 15px;
        }
    </style>
</head>
<body>

<header>
     <a href="../Store%2002/manager.html">
      <img src="../logo.jpg" alt="Jensen Tire & Auto Logo">
    </a>
    <div id="hamburger" onclick="toggleMenu()">☰</div>
</header>

<nav id="nav-menu">
  <a href="../index.html">Main Dashboard</a>
  <a href="../Store%2002/manager.html">Manager Courses</a>
  <a href="#" onclick="openFeedbackPopup()">Submit Feedback</a>
  <a href="#" class="nav-link open-zammad-chat">Jensen Support chat</a>
  <a href="https://jensentireandauto.com/" target="_blank">Retail Site</a>
</nav>
    
<section id="role">
  <div class="container">
    <h1>ISolved Resources - Store 02</h1>
    <p>Follow the instructions below to access your ISolved time and attendance portal.</p>

  <div class="training-buttons">    
    <a class="button" href="https://identity.myisolved.com/Account/Login" target="_blank">Isolved portal</a>
  </div>
      
    <p class="instructions">
      <div class="training-buttons">    
        <a class="button" href="../Isolved.pdf" target="_blank">Instruction Guide</a>
      </div>
    </p>

      <div class="training-buttons">    
        <a class="button" href="#" onclick="requestBtn()">Request Manager Instructions</a>
      </div>

    <footer style="margin-top: 40px;">
        Questions? Contact <a href="mailto:support@jensentireandauto.com">Jensen Support</a>
    </footer>
  </div>
</section>

<div id="feedbackPopup" class="feedback-popup">
  <div class="feedback-content">
    <h3>We value your input!</h3>
    <form id="feedback-form">
      <textarea
        id="feedback"
        name="feedback"
        placeholder="Leave your feedback here..."
        required
      ></textarea>
      <br />
      <button type="submit" class="button">Submit</button>
      <button type="button" class="button" onclick="closeFeedbackPopup()">Cancel</button>
    </form>
    <p id="thank-you" style="display: none; color: black; margin-top: 20px;">Thank you for your feedback!</p>
  </div>
</div>

<script>
function openFeedbackPopup() {
  document.getElementById('feedbackPopup').style.display = 'block';
}

function closeFeedbackPopup() {
  document.getElementById('feedbackPopup').style.display = 'none';
}

document.getElementById("feedback-form").addEventListener("submit", async function (e) {
  e.preventDefault();
  const feedback = document.getElementById("feedback").value;

  const response = await fetch("https://default4e006550b51242c29ec2b301c0fa6a.51.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/5a8c354b3a634ab893a5879f150f715d/triggers/manual/paths/invoke/?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=Jr-fRt0XwxxcfPUPvbpjS-xwfZlb2rjb4J_L2xwhXFg", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({ feedback })
  });

  if (response.ok) {
    document.getElementById("feedback").value = "";
    document.getElementById("thank-you").style.display = "block";
    setTimeout(() => {
      document.getElementById("thank-you").style.display = "none";
      closeFeedbackPopup();
    }, 2000);
  } else {
    alert("Submission failed. Please try again.");
  }
});
</script>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script src="https://jensensupport.co/assets/chat/chat.min.js"></script>

<script>
$(function() {
  const zammadChatInstance = new ZammadChat({
    title: 'Jensen Support',
    background: 'rgb(249, 117, 38)',
    fontSize: '12px',
    chatId: 1,
  });

  $('.open-zammad-chat').on('click', function(e) {
    e.preventDefault();
    zammadChatInstance.show();
  });
});
</script>

<script>
  function toggleMenu() {
    const menu = document.getElementById("nav-menu");
    menu.classList.toggle("open");
  }

function closeMenu() {
    const menu = document.getElementById("nav-menu");
    menu.classList.remove("open");
  }

  document.addEventListener("click", function (event) {
    const menu = document.getElementById("nav-menu");
    const hamburger = document.getElementById("hamburger");

    if (
      menu.classList.contains("open") &&
      !menu.contains(event.target) &&
      !hamburger.contains(event.target)
    ) {
      closeMenu();
    }
  });

  document.addEventListener("keydown", function (event) {
    if (event.key === "Escape") {
      closeMenu();
    }
  });
    
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(function() {
    alert('Copied: ' + text);
  }, function(err) {
    alert('Failed to copy: ' + err);
  });
}
</script>

<script>
  // 1) Paste your Power Automate HTTP POST URL here:
  const FLOW_URL = 'https://default4e006550b51242c29ec2b301c0fa6a.51.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/b2ed9557d4644a7ab9f70211c4a3bf33/triggers/manual/paths/invoke/?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=QSoxbZBeYymcAn1YdINQpX5pMMJ6ophzTiSdIzIGmTE';

  const dialogEl = document.getElementById('requestDialog');
  const btnEl = document.getElementById('requestBtn');
  const formEl = document.getElementById('requestForm');
  const cancelEl = document.getElementById('cancelBtn');
  const nameEl = document.getElementById('nameInput');
  const statusEl = document.getElementById('status');

  btnEl.addEventListener('click', () => {
    dialogEl.showModal();
    nameEl.focus();
  });

  cancelEl.addEventListener('click', () => dialogEl.close());

  formEl.addEventListener('submit', async (e) => {
    e.preventDefault();

    const name = nameEl.value.trim();
    if (!name) {
      statusEl.textContent = 'Please enter your name.';
      nameEl.focus();
      return;
    }

    statusEl.textContent = 'Sending...';

    try {
      // Send as text/plain to avoid CORS preflight; body is still JSON and will be parsed in the flow.
      const resp = await fetch(FLOW_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'text/plain' },
        body: JSON.stringify({ name })
      });

      if (!resp.ok) throw new Error(`HTTP ${resp.status}`);

      // If CORS header is set in your flow's Response, we can read JSON and show a friendly message
      let msg = 'Request sent.';
      try {
        const data = await resp.json();
        if (data && data.ok) msg = `Thanks, ${data.received || name}. Your request was sent.`;
      } catch (_) { /* ignore if server didn’t return JSON */ }

      statusEl.textContent = msg;
      formEl.reset();
      setTimeout(() => dialogEl.close(), 1200);
    } catch (err) {
      console.error(err);
      statusEl.textContent = 'Sorry, something went wrong. Please try again later.';
    }
  });
</script>

</body>
</html>
